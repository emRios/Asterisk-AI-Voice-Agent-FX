active_pipeline: deepgram_full_local
asterisk:
  app_name: asterisk-ai-voice-agent
audio_transport: audiosocket
audiosocket:
  format: slin
  host: "172.31.7.92"
  port: 9092
barge_in:
  enabled: true
  energy_threshold: 1500
  initial_protection_ms: 300
  min_ms: 300
  post_tts_end_protection_ms: 200
config_version: 4
contexts:
  default:
    greeting: Hello
    profile: telephony_ulaw_8k
    prompt: You are Asterisk, a Assistant. Be helpful and concise.
    provider: deepgram
  # Example context with background music (AAVA-89)
  # background_music references a MOH class from /etc/asterisk/musiconhold.conf
  # Place audio files in /var/lib/asterisk/moh/{class-name}/ (pre-reduced volume recommended)
  # demo_with_music:
  #   greeting: Welcome to our premium line!
  #   profile: telephony_ulaw_8k
  #   provider: deepgram
  #   background_music: default  # MOH class name
default_provider: deepgram
downstream_mode: stream
external_media:
  codec: ulaw
  direction: both
  format: slin16
  port_range: 18080:18099
  rtp_host: 127.0.0.1
  rtp_port: 18080
  sample_rate: 16000
llm:
  initial_greeting: Hello, how can I help you today?
  prompt: Voice assistant. Answer in 5-8 words. Be direct. Expand only if asked.
pipelines:
  # Nuevo pipeline híbrido:
  # STT: Deepgram (REST / streaming según options.stt)
  # LLM: DeepInfra (OpenAI-compatible) vía openai_llm
  # TTS: Deepgram TTS
  deepgram_full_local:
   provider: deepgram
profiles:
  default: telephony_responsive
  openai_realtime_24k:
    chunk_ms: 20
    idle_cutoff_ms: 0
    internal_rate_hz: 24000
    provider_pref:
      input_encoding: pcm16
      input_sample_rate_hz: 24000
      output_encoding: pcm16
      output_sample_rate_hz: 24000
    transport_out:
      encoding: slin
      sample_rate_hz: 8000
  telephony_responsive:
    chunk_ms: auto
    idle_cutoff_ms: 600
    internal_rate_hz: 8000
    provider_pref:
      input_encoding: mulaw
      input_sample_rate_hz: 8000
      output_encoding: mulaw
      output_sample_rate_hz: 8000
    transport_out:
      encoding: slin
      sample_rate_hz: 8000
  telephony_ulaw_8k:
    chunk_ms: auto
    idle_cutoff_ms: 800
    internal_rate_hz: 8000
    provider_pref:
      input_encoding: mulaw
      input_sample_rate_hz: 8000
      output_encoding: mulaw
      output_sample_rate_hz: 8000
    transport_out:
      encoding: ulaw
      sample_rate_hz: 8000
  wideband_pcm_16k:
    chunk_ms: auto
    idle_cutoff_ms: 1200
    internal_rate_hz: 16000
    provider_pref:
      input_encoding: linear16
      input_sample_rate_hz: 16000
      output_encoding: linear16
      output_sample_rate_hz: 16000
    transport_out:
      encoding: slin16
      sample_rate_hz: 16000
providers:
  deepgram:
    enabled: true
    voice_agent_base_url: ws://127.0.0.1:8765/v1/agent/converse
    type: full
  local:
    enabled: false
streaming:
  chunk_size_ms: 20
  connection_timeout_ms: 120000
  continuous_stream: true
  diag_enable_taps: true
  diag_out_dir: /tmp/ai-engine-taps
  diag_post_secs: 1
  diag_pre_secs: 1
  empty_backoff_ticks_max: 5
  fallback_timeout_ms: 8000
  greeting_min_start_ms: 40
  jitter_buffer_ms: 100
  keepalive_interval_ms: 5000
  low_watermark_ms: 200
  min_start_ms: 300
  normalizer:
    enabled: true
    max_gain_db: 18
    target_rms: 1400
  provider_grace_ms: 200
  sample_rate: 8000
tools:
  ai_identity:
    name: AI Agent
    number: '6789'
  cancel_transfer:
    allow_after_answer: false
    allow_during_ring: true
    enabled: true
  default_action_timeout: 30
  enabled: true
  extensions:
    internal:
      '6000':
        action_type: transfer
        aliases:
        - agent
        - representative
        - human
        - real person
        - live person
        - someone
        - support
        - sales
        - operator
        - help desk
        description: Live customer service representative
        dial_string: SIP/6000
        mode: warm
        name: Live Agent
        pass_caller_info: true
        timeout: 30
        transfer: true
  hangup_call:
    enabled: true
    farewell_message: Thank you for calling. Goodbye!
    require_confirmation: false
  leave_voicemail:
    enabled: true
    extension: '2765'
  request_transcript:
    admin_email: haider@jugaar.llc
    api_key: ${RESEND_API_KEY}
    common_domains:
    - gmail.com
    - yahoo.com
    - outlook.com
    - hotmail.com
    - icloud.com
    confirm_email: true
    enabled: true
    from_email: ava@jugaar.llc
    from_name: AI Voice Agent
    max_attempts: 2
    provider: resend
    validate_domain: true
  send_email_summary:
    admin_email: haider@jugaar.llc
    api_key: ${RESEND_API_KEY}
    enabled: true
    from_email: ava@jugaar.llc
    from_name: AI Voice Agent
    include_metadata: true
    include_transcript: true
    provider: resend
  transfer:
    destinations:
      sales_agent:
        description: Sales agent
        target: '2765'
        type: extension
      sales_queue:
        description: Sales team queue
        target: '300'
        type: queue
      sales_team:
        description: Sales team ring group
        target: '600'
        type: ringgroup
      support_agent:
        description: Support agent
        target: '6000'
        type: extension
      support_queue:
        description: Technical support queue
        target: '301'
        type: queue
      support_team:
        description: Support team ring group
        target: '601'
        type: ringgroup
    enabled: true
    # Call event notification tool - business events to Redis Streams
  CallEventNotification:
    # Backend de cola a utilizar por la tool
    queue_backend: http

    # Configuración específica de Redis para esta tool
    http:
      # URL de conexión a Redis; se puede sobreescribir con la variable de entorno REDIS_URL
      url: ${CALL_EVENT_HTTP_URL:-http://172.31.7.92:8080/ingest}
      timeout_secs: 5
    enabled: true

    # Tipos de eventos que esta tool está autorizada a publicar
    enabled_event_types:
      - PURCHASE_INTENT_HIGH
      - TRANSFER_REQUESTED
      - HARD_REJECTION
      - SOFT_REJECTION
      - ESCALATION_REQUIRED
      - POSITIVE_FEEDBACK
      - NEGATIVE_FEEDBACK
    enabled: true
vad:
  enhanced_enabled: false
  fallback_buffer_size: 128000
  fallback_enabled: true
  fallback_interval_ms: 4000
  max_utterance_duration_ms: 10000
  min_utterance_duration_ms: 600
  #use_provider_vad: false
  utterance_padding_ms: 200
  webrtc_aggressiveness: 1
  webrtc_end_silence_frames: 50
  webrtc_start_frames: 3
  silence_duration_ms: 800
